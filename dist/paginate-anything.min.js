// angular-paginate-anything - v4.2.0

!function(){"use strict";function u(e){return Math.floor(Math.pow(10,Math.floor(e/3))*[1,2.5,5][e%3])}function p(e){if(e<1)return 0;var t=Math.floor(Math.log(e)/Math.LN10),a=e/(2.5*Math.pow(10,t));return 3<=a&&(t++,a=0),3*t+Math.round(Math.min(2,a))}function g(e){return e===1/0?1/0:u(p(e))}function l(e){return e.to-e.from+1}angular.module("bgf.paginateAnything",[]).directive("bgfPagination",function(){return{restrict:"AE",scope:{url:"=",collection:"=",urlParams:"=?",headers:"=?",page:"=?",perPage:"=?",perPagePresets:"=?",autoPresets:"=?",clientLimit:"=?",linkGroupSize:"=?",reloadPage:"=?",size:"=?",selectClass:"=?",perPageClass:"=?",passive:"@",transformResponse:"=?",method:"@",postData:"=?",loadFn:"&",numPages:"=?",numItems:"=?",serverLimit:"=?",rangeFrom:"=?",rangeTo:"=?"},templateUrl:function(e,t){return t.templateUrl||"src/paginate-anything.html"},replace:!0,controller:["$scope","$attrs","$http",function(i,e,r){i.reloadPage=!1,i.serverLimit=1/0,i.Math=window.Math;var n=void 0!==e.loadFn;"boolean"!=typeof i.autoPresets&&(i.autoPresets=!0);var t=i.linkGroupSize,a=i.clientLimit;function o(o){if("true"!==i.passive&&(i.url||n)){i.$emit("pagination:loadStart",o);var e,t,a={method:i.method||"GET",url:i.url,params:i.urlParams,data:i.postData,headers:angular.extend({},i.headers,{"Range-Unit":"items",Range:[o.from,o.to].join("-")}),transformResponse:(e=r.defaults.transformResponse,t=i.transformResponse,e=angular.isArray(e)?e:[e],t?e.concat(t):e)};(n?i.loadFn({config:a}):r(a)).then(function(e){var t,a,r=(t=e.headers("Content-Range"),(a=t&&t.match(/^(?:items )?(\d+)-(\d+)\/(\d+|\*)$/))?{from:+a[1],to:+a[2],total:"*"===a[3]?1/0:+a[3]}:"*/0"===t?{total:0}:null);if(204===e.status||r&&0===r.total?(i.numItems=0,i.collection=[]):(i.numItems=r?r.total:e.data.length,i.collection=e.data||[]),r&&(i.rangeFrom=r.from,i.rangeTo=r.to,l(r)<r.total&&(o.to<r.total-1||r.to<r.total-1&&r.total<o.to)&&(!i.perPage||l(r)<i.perPage))){if(i.autoPresets){var n=p(l(r));u(n)>l(r)&&n--,i.serverLimit=u(n)}else i.serverLimit=l(r);i.perPage=i.Math.min(i.serverLimit,i.clientLimit)}i.numPages=Math.ceil(i.numItems/(i.perPage||50)),i.$emit("pagination:loadPage",e.status,e.config)},function(e){i.$emit("pagination:error",e.status,e.config)})}}i.linkGroupSize="number"==typeof t?t:3,i.clientLimit="number"==typeof a?a:250,i.updatePresets=function(){if(i.autoPresets){var e,t=[];for(e=Math.min(3,p(i.perPage||50));e<=p(Math.min(i.clientLimit,i.serverLimit));e++)t.push(u(e));i.perPagePresets=t}else i.perPagePresets=i.perPagePresets.filter(function(e){return e<=i.serverLimit}).concat([i.serverLimit])},i.gotoPage=function(e){e<0||e*i.perPage>=i.numItems||(i.page=e)},i.linkGroupFirst=function(){var e=Math.max(0,i.linkGroupSize-(i.numPages-1-(i.page+2)));return Math.max(0,i.page-(i.linkGroupSize+e))},i.linkGroupLast=function(){var e=Math.max(0,i.linkGroupSize-(i.page-2));return Math.min(i.numPages-1,i.page+(i.linkGroupSize+e))},i.isFinite=function(){return i.numPages<1/0},i.page=i.page||0,i.size=i.size||"md",i.autoPresets&&i.updatePresets(),i.$watch("page",function(e,t){if("true"!==i.passive&&e!==t){if(e<0||e*i.perPage>=i.numItems)return;var a=i.perPage||50;i.autoPresets&&(a=g(a)),o({from:e*a,to:(e+1)*a-1})}}),i.$watch("perPage",function(e,t){if("true"!==i.passive&&"number"==typeof t&&e!==t){var a=i.page*t,r=Math.floor(a/e);i.page!==r?i.page=r:o({from:i.page*e,to:(i.page+1)*e-1})}}),i.$watch("serverLimit",function(e,t){"true"!==i.passive&&e!==t&&i.updatePresets()}),i.$watch("url",function(e,t){"true"!==i.passive&&e!==t&&(0===i.page?i.reloadPage=!0:i.page=0)}),i.$watch("urlParams",function(e,t){"true"!==i.passive&&(angular.equals(e,t)||(0===i.page?i.reloadPage=!0:i.page=0))},!0),i.$watch("headers",function(e,t){"true"!==i.passive&&(angular.equals(e,t)||(0===i.page?i.reloadPage=!0:i.page=0))},!0),i.$watch("reloadPage",function(e,t){if("true"!==i.passive&&!0===e&&!1===t){var a=i.perPage||50;i.reloadPage=!1,o({from:i.page*a,to:(i.page+1)*a-1})}}),i.$watch("transformResponse",function(e,t){"true"!==i.passive&&e&&t&&(angular.equals(e.toString(),t.toString())||(0===i.page?i.reloadPage=!0:i.page=0))},!0),i.$on("pagination:reload",function(){i.reloadPage=!0});var s=i.perPage||50;i.autoPresets&&(s=g(s)),o({from:i.page*s,to:(i.page+1)*s-1})}]}}).filter("makeRange",function(){return function(e){var t,a;switch(e.length){case 1:t=0,a=parseInt(e[0],10)-1;break;case 2:t=parseInt(e[0],10),a=parseInt(e[1],10);break;default:return e}for(var r=[],n=t;n<=a;n++)r.push(n);return r}})}();